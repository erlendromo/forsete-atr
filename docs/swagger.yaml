definitions:
  atr.ATRRequest:
    description: Body containing line_segmentation_model, text_recognition_model and
      image_ids.
    properties:
      image_ids:
        items:
          type: string
        type: array
      line_segmentation_model:
        type: string
      text_recognition_model:
        type: string
    type: object
  atr.ATRResponse:
    description: Json-Response for ATR
    properties:
      contains:
        items:
          properties:
            segment:
              properties:
                bbox:
                  properties:
                    xmax:
                      type: integer
                    xmin:
                      type: integer
                    ymax:
                      type: integer
                    ymin:
                      type: integer
                  type: object
                class_label:
                  type: string
                data:
                  type: object
                orig_shape:
                  items:
                    type: integer
                  type: array
                polygon:
                  properties:
                    points:
                      items:
                        properties:
                          x:
                            type: integer
                          "y":
                            type: integer
                        type: object
                      type: array
                  type: object
                score:
                  type: number
              type: object
            text_result:
              properties:
                label:
                  type: string
                scores:
                  items:
                    type: number
                  type: array
                texts:
                  items:
                    type: string
                  type: array
              type: object
          type: object
        type: array
      file_name:
        type: string
      image_name:
        type: string
      label:
        type: string
    type: object
  auth.RegisterAndLoginRequest:
    description: Body containing email and password.
    properties:
      email:
        type: string
      password:
        type: string
    type: object
  file.UpdateOutputForm:
    description: Form containing confirmed and data associated with the update request.
    properties:
      confirmed:
        type: boolean
      data:
        $ref: '#/definitions/output.ATRResponse'
    type: object
  github_com_erlendromo_forsete-atr_src_api_handler_v1_status.Status:
    description: Json-response for Status
    properties:
      atr:
        type: string
      uptime:
        type: string
      version:
        type: string
    type: object
  github_com_erlendromo_forsete-atr_src_api_handler_v2_status.Status:
    description: Status containing ATR-readiness, database-readiness, version and
      uptime.
    properties:
      atr:
        type: string
      database:
        type: string
      uptime:
        type: string
      version:
        type: string
    type: object
  github_com_erlendromo_forsete-atr_src_business_domain_image.Image:
    description: Image containing id, name, format etc.
    properties:
      format:
        type: string
      id:
        type: string
      name:
        type: string
    type: object
  github_com_erlendromo_forsete-atr_src_business_domain_model.Model:
    description: Model containing id, name etc.
    properties:
      id:
        type: integer
      model_type:
        type: string
      name:
        type: string
    type: object
  github_com_erlendromo_forsete-atr_src_domain_modelstore_model.Model:
    properties:
      name:
        type: string
    type: object
  model.ModelsResponse:
    description: Json-Response for models
    properties:
      line_segmentation_models:
        items:
          $ref: '#/definitions/github_com_erlendromo_forsete-atr_src_domain_modelstore_model.Model'
        type: array
      region_segmentation_models:
        items:
          $ref: '#/definitions/github_com_erlendromo_forsete-atr_src_domain_modelstore_model.Model'
        type: array
      text_recognition_models:
        items:
          $ref: '#/definitions/github_com_erlendromo_forsete-atr_src_domain_modelstore_model.Model'
        type: array
    type: object
  output.ATRResponse:
    properties:
      contains:
        items:
          properties:
            segment:
              properties:
                bbox:
                  properties:
                    xmax:
                      type: integer
                    xmin:
                      type: integer
                    ymax:
                      type: integer
                    ymin:
                      type: integer
                  type: object
                class_label:
                  type: string
                data:
                  type: object
                orig_shape:
                  items:
                    type: integer
                  type: array
                polygon:
                  properties:
                    points:
                      items:
                        properties:
                          x:
                            type: integer
                          "y":
                            type: integer
                        type: object
                      type: array
                  type: object
                score:
                  type: number
              type: object
            text_result:
              properties:
                label:
                  type: string
                scores:
                  items:
                    type: number
                  type: array
                texts:
                  items:
                    type: string
                  type: array
              type: object
          type: object
        type: array
      file_name:
        type: string
      image_name:
        type: string
      label:
        type: string
    type: object
  output.Output:
    description: Output containing id, name, format, confirmed, image_id etc.
    properties:
      confirmed:
        type: boolean
      format:
        type: string
      id:
        type: string
      image_id:
        type: string
      name:
        type: string
    type: object
  session.Session:
    description: Session containing token etc.
    properties:
      token:
        type: string
    type: object
  user.User:
    description: User containing id, email etc.
    properties:
      email:
        type: string
      id:
        type: string
    type: object
  util.ErrorResponse:
    description: Json-Response on error
    properties:
      error:
        type: string
      status:
        type: integer
    type: object
info:
  contact: {}
  description: RESTful JSON-API for Automatic Text Recognition (ATR) developed as
    part of Bachelor Thesis "FORSETE" at NTNU Gj√∏vik.
  title: Forsete-ATR
  version: v2
paths:
  /forsete-atr/v1/atr/basic-documents/:
    post:
      consumes:
      - multipart/form-data
      description: Run ATR on image-file
      parameters:
      - description: png, jpg, jpeg
        in: formData
        name: image
        required: true
        type: file
      - description: name of line segmentation model
        in: formData
        name: line_segmentation_model
        required: true
        type: string
      - description: name of text recognition model
        in: formData
        name: text_recognition_model
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/atr.ATRResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: ATR
      tags:
      - ATR
  /forsete-atr/v1/atr/tipnote-documents/:
    post:
      consumes:
      - multipart/form-data
      description: Run ATR on image-file
      parameters:
      - description: png, jpg, jpeg
        in: formData
        name: image
        required: true
        type: file
      - description: name of the region segmentation model
        in: formData
        name: region_segmentation_model
        required: true
        type: string
      - description: name of line segmentation model
        in: formData
        name: line_segmentation_model
        required: true
        type: string
      - description: name of text recognition model
        in: formData
        name: text_recognition_model
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/atr.ATRResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: ATR
      tags:
      - ATR
  /forsete-atr/v1/models/:
    get:
      description: Retrieve all active models
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.ModelsResponse'
      summary: Models
      tags:
      - Models
  /forsete-atr/v1/models/line-segmentation-models/:
    get:
      description: Retrieve all active line segmentation models
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.ModelsResponse'
      summary: LineSegmentationModels
      tags:
      - LineSegmentationModels
    post:
      consumes:
      - multipart/form-data
      description: Add a line segmentation model
      parameters:
      - description: Name of the model
        in: formData
        name: model_name
        required: true
        type: string
      - description: model.pt
        in: formData
        name: model
        required: true
        type: file
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: LineSegmentationModels
      tags:
      - LineSegmentationModels
  /forsete-atr/v1/models/region-segmentation-models/:
    get:
      description: Retrieve all active region segmentation models
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.ModelsResponse'
      summary: RegionSegmentationModels
      tags:
      - RegionSegmentationModels
    post:
      consumes:
      - multipart/form-data
      description: Add a region segmentation model
      parameters:
      - description: Name of the model
        in: formData
        name: model_name
        required: true
        type: string
      - description: model.pt
        in: formData
        name: model
        required: true
        type: file
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: RegionSegmentationModels
      tags:
      - RegionSegmentationModels
  /forsete-atr/v1/models/text-recognition-models/:
    get:
      description: Retrieve all active text recognition models
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/model.ModelsResponse'
      summary: TextRecognitionModels
      tags:
      - TextRecognitionModels
    post:
      consumes:
      - multipart/form-data
      description: Add a text recognition model
      parameters:
      - description: Name of the model
        in: formData
        name: model_name
        required: true
        type: string
      - description: model.safetensors
        in: formData
        name: model
        required: true
        type: file
      - description: config.json
        in: formData
        name: config
        required: true
        type: file
      - description: generation_config.json
        in: formData
        name: generation_config
        required: true
        type: file
      - description: merges.txt
        in: formData
        name: merges
        required: true
        type: file
      - description: preprocessor_config.json
        in: formData
        name: preprocessor_config
        required: true
        type: file
      - description: special_tokens_map.json
        in: formData
        name: special_tokens_map
        required: true
        type: file
      - description: tokenizer.json
        in: formData
        name: tokenizer
        required: true
        type: file
      - description: tokenizer_config.json
        in: formData
        name: tokenizer_config
        required: true
        type: file
      - description: vocab.json
        in: formData
        name: vocab
        required: true
        type: file
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: TextRecognitionModels
      tags:
      - TextRecognitionModels
  /forsete-atr/v1/status/:
    get:
      description: Retrieve status of service
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_erlendromo_forsete-atr_src_api_handler_v1_status.Status'
      summary: GetStatus
      tags:
      - Status
    head:
      description: Retrieve status of service
      responses:
        "204":
          description: No Content
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: HeadStatus
      tags:
      - Status
  /forsete-atr/v2/atr/:
    post:
      consumes:
      - application/json
      description: Run ATR on images
      parameters:
      - description: '''Bearer <token>'' must be set for valid response'
        in: header
        name: Authorization
        required: true
        type: string
      - description: Body containing which models to use, alongside the image_ids
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/atr.ATRRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/output.Output'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "422":
          description: Unprocessable Entity
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Run ATR
      tags:
      - ATR
  /forsete-atr/v2/auth/login/:
    post:
      consumes:
      - application/json
      description: Login as user with email and password.
      parameters:
      - description: Login user form
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/auth.RegisterAndLoginRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          headers:
            Authorization:
              description: Bearer <token>
              type: string
          schema:
            $ref: '#/definitions/session.Session'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "422":
          description: Unprocessable Entity
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Login as user
      tags:
      - Auth
  /forsete-atr/v2/auth/logout/:
    post:
      description: Logout as user.
      parameters:
      - description: '''Bearer <token>'' must be set for valid response'
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Logout as user
      tags:
      - Auth
  /forsete-atr/v2/auth/refresh/:
    post:
      description: Refresh session token.
      parameters:
      - description: '''Bearer <token>'' must be set for valid response'
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          headers:
            Authorization:
              description: Bearer <token>
              type: string
          schema:
            $ref: '#/definitions/session.Session'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Refresh token
      tags:
      - Auth
  /forsete-atr/v2/auth/register/:
    post:
      consumes:
      - application/json
      description: Register user with email and password.
      parameters:
      - description: Register user form
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/auth.RegisterAndLoginRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/user.User'
        "422":
          description: Unprocessable Entity
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Register user
      tags:
      - Auth
  /forsete-atr/v2/images/:
    get:
      description: Get all images the user has uploaded.
      parameters:
      - description: '''Bearer <token>'' must be set for valid response'
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/github_com_erlendromo_forsete-atr_src_business_domain_image.Image'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Get images
      tags:
      - Images
  /forsete-atr/v2/images/{imageID}/:
    get:
      description: Get image by id.
      parameters:
      - description: uuid of image
        in: query
        name: imageID
        required: true
        type: string
      - description: '''Bearer <token>'' must be set for valid response'
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_erlendromo_forsete-atr_src_business_domain_image.Image'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "422":
          description: Unprocessable Entity
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Get image by id
      tags:
      - Images
  /forsete-atr/v2/images/{imageID}/data/:
    get:
      description: Get image data.
      parameters:
      - description: uuid of image
        in: query
        name: imageID
        required: true
        type: string
      - description: '''Bearer <token>'' must be set for valid response'
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: image file
          schema:
            type: body
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "422":
          description: Unprocessable Entity
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Get image data
      tags:
      - Images
  /forsete-atr/v2/images/{imageID}/outputs/:
    get:
      description: Get outputs by image id.
      parameters:
      - description: uuid of image
        in: query
        name: imageID
        required: true
        type: string
      - description: '''Bearer <token>'' must be set for valid response'
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/output.Output'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "422":
          description: Unprocessable Entity
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Get outputs by image id
      tags:
      - Outputs
  /forsete-atr/v2/images/{imageID}/outputs/{outputID}/:
    get:
      description: Get output by id.
      parameters:
      - description: uuid of image
        in: query
        name: imageID
        required: true
        type: string
      - description: uuid of output
        in: query
        name: outputID
        required: true
        type: string
      - description: '''Bearer <token>'' must be set for valid response'
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/output.Output'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "422":
          description: Unprocessable Entity
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Get output by id
      tags:
      - Outputs
    put:
      description: Update output by id.
      parameters:
      - description: uuid of image
        in: query
        name: imageID
        required: true
        type: string
      - description: uuid of output
        in: query
        name: outputID
        required: true
        type: string
      - description: '''Bearer <token>'' must be set for valid response'
        in: header
        name: Authorization
        required: true
        type: string
      - description: Body containing confirmed and data to update
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/file.UpdateOutputForm'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/output.ATRResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "422":
          description: Unprocessable Entity
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Update output by id
      tags:
      - Outputs
  /forsete-atr/v2/images/{imageID}/outputs/{outputID}/data/:
    get:
      description: Get output data.
      parameters:
      - description: uuid of image
        in: query
        name: imageID
        required: true
        type: string
      - description: uuid of output
        in: query
        name: outputID
        required: true
        type: string
      - description: '''Bearer <token>'' must be set for valid response'
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/output.ATRResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "422":
          description: Unprocessable Entity
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Get output data.
      tags:
      - Outputs
  /forsete-atr/v2/images/upload/:
    post:
      description: Upload up to 32MB worth of images.
      parameters:
      - description: '''Bearer <token>'' must be set for valid response'
        in: header
        name: Authorization
        required: true
        type: string
      - description: images to upload
        in: formData
        name: images
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_erlendromo_forsete-atr_src_business_domain_image.Image'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "422":
          description: Unprocessable Entity
          schema:
            $ref: '#/definitions/util.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Upload images
      tags:
      - Images
  /forsete-atr/v2/models/:
    get:
      description: Get all models.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/github_com_erlendromo_forsete-atr_src_business_domain_model.Model'
            type: array
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Get models
      tags:
      - Models
  /forsete-atr/v2/models/{type}/:
    get:
      description: Get models by type.
      parameters:
      - description: type = region-segmentation-models/line-segmentation-models/text-recognition-models
        in: query
        name: type
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/github_com_erlendromo_forsete-atr_src_business_domain_model.Model'
            type: array
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Get models by type
      tags:
      - Models
  /forsete-atr/v2/status/:
    get:
      description: Get status.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_erlendromo_forsete-atr_src_api_handler_v2_status.Status'
      summary: Get status
      tags:
      - Status
    head:
      description: Head status.
      responses:
        "204":
          description: No Content
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/util.ErrorResponse'
      summary: Head status
      tags:
      - Status
swagger: "2.0"
